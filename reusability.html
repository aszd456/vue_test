<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="css/reusability.css"/>
		<script src="js/vue.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/reusability.js" type="text/javascript" charset="utf-8"></script>
		<title></title>
	</head>
	<body>
		<div id="">
			<h2>新库用户管理列表</h2>
			SELECT st6110.F02 '账号',st6141.F02 '姓名',st6141.F07 '身份证',st6110.F04 '手机号码',
			(CASE st6110.F06 WHEN 'ZRR' THEN '自然人' ELSE '非自然人' END) '用户类型',st6110.F09 '注册时间',st6114.F07 '银行卡号' 
			FROM s61.t6110 as st6110
			LEFT JOIN s61.t6141 as st6141 ON st6141.F01=st6110.F01
			LEFT JOIN s61.t6114 as st6114 ON st6114.F02=st6110.F01
			WHERE st6141.F02 is not null;
			<h2>旧库用户管理列表</h2>
			SELECT u.login_name '账号', u.real_name '姓名',decodeIdcard(u.idcard) '身份证',u.mobile '电话',
			(CASE u.user_type WHEN 'per' THEN '个人' WHEN 'ent' THEN '企业' ELSE '机构' END) as '用户类型' ,u.create_time '注册时间', bc.cardno '银行卡号'
			FROM `user` as u
			LEFT JOIN bank_card bc ON bc.user_id = u.id
			WHERE u.real_name is not null;
		</div>
		<hr >
		<div id="">
			<h2>旧平台借款标的台账(成立以来全部数据)</h2>
			SELECT (CASE lo.type WHEN 'warrant' THEN '担保标' end) '标的类别',lo.bid_num '标的号',lo.title '标名称', lo.amount '贷款金额',u.id '贷款人账号ID',u.real_name '贷款人姓名',
			decodeIdcard(u.idcard) '身份证号码',lo.create_time '标的发布时间',lo.full_time '满标时间',lo.deal_time '放款时间',lo.repaid_time '到期时间',
			lo.repayment_months '借款期限（月）',
			(case lo.repayment_type WHEN 'xxhb' THEN '按月结息到期还本' WHEN 'debx' THEN '等额本息' WHEN 'debj' THEN '等额本金' WHEN 'ycxhbfx' THEN '一次性还本息' WHEN 'xyms' THEN '等额本息(分期)' ELSE '分段还款' END)
			'还款方式',lo.lastupdate '最后还款时间',lo.year_rate '年化利率',
			lo.mgmt_rate  '借款管理费率',(case WHEN lo.warrant_org=78 THEN '中顺盈腾融资担保有限公司' ELSE '其他' END) '担保公司',
			(CASE WHEN lo.amount=(SELECT SUM(principal) FROM repayment WHERE loan_id=lo.id and user_id=lo.user_id and is_dianfu='no') THEN '结清' WHEN lo.`status`='cancelled' THEN '取消单' ELSE '垫付' END) '还款状态'
			FROM `loan_object` as lo
			LEFT JOIN `user` u ON u.id = lo.user_id
			WHERE title NOT LIKE '%测试%';

			<h2>新平台借款标的台账(成立以来全部数据)</h2>
			SELECT st6211.F02 '标的类别',st6230.F25 '标编号',st6230.F03 '借款标题',st6230.F05 '借款金额' ,st6230.F02 '借款用户ID',st6141.F02 '姓名',
						st6141.F07 '身份证号码',st6230.F22 '发布时间',st6231.F11 '满标时间',st6231.F12 '放款时间',st6231.F13 '到期时间',st6230.F09 '借款期限（月）',
						(case WHEN st6230.F10='DEBX' THEN '等额本息' WHEN st6230.F10='MYFX' THEN '每月付息,到期还本' WHEN st6230.F10='YCFQ' THEN '本息到期一次付清' ELSE '等额本金' END)'还款方式'
			, st6231.F06 '最后还款时间',st6230.F06 '借款利率',st6238.F02 '服务费率',
			(CASE WHEN st6230.F05=(SELECT SUM(st6252.F07) FROM s62.t6252 st6252 WHERE st6252.F05=7001 AND st6252.F09='YH' AND st6252.F03=st6230.F02) THEN '结清' ELSE '垫付' END) '还款状态'
						FROM s62.t6230 st6230
						LEFT JOIN s62.t6211 st6211 ON st6230.F04=st6211.F01
						LEFT JOIN s61.t6141 st6141 ON st6230.F02=st6141.F01
						LEFT JOIN s62.t6231 st6231 ON st6231.F01 = st6230.F01
						LEFT JOIN s62.t6238 st6238 ON st6230.F01 = st6238.F01
						WHERE st6230.F03 not LIKE '%测试%';
			<hr >

		</div>
		<div id="">
			<h2>旧平台出借人投标台账(成立以来全部数据)</h2>
			SELECT b.user_id '投资人帐号ID',u.real_name '投资人姓名',decodeIdcard(u.idcard) '身份证号',b.bid_time '投标时间',b.amount '投标金额'
			,(case WHEN b.`status`='failure' THEN '是' ELSE '否' END) '是否作废',lo.bid_num '借款标的号',lo.title '借款标的名称',lo.amount '借款标金额',lo.year_rate '借款标利率'
			,(case lo.repayment_type WHEN 'xxhb' THEN '按月结息到期还本' WHEN 'debx' THEN '等额本息' WHEN 'debj' THEN '等额本金' WHEN 'ycxhbfx' THEN '一次性还本息' WHEN 'xyms' THEN '等额本息(分期)' ELSE '分段还款' END) '还款方式' 
			,(CASE WHEN lo.amount=(SELECT SUM(principal) FROM repayment WHERE loan_id=lo.id and user_id=lo.user_id and is_dianfu='no') THEN '结清' WHEN lo.`status`='cancelled' THEN '取消单' ELSE '垫付' END) '还款状态' 
			,(case WHEN bid_type='zhaiquan' THEN '是' ELSE '否' END) '是否债转'
			FROM bidding b
			LEFT JOIN `user` u ON u.id=b.user_id
			LEFT JOIN loan_object lo ON lo.id = b.loan_id
			WHERE lo.title not LIKE '%测试%';
			
			<h2>新平台出借人投标台账(成立以来全部数据)</h2>
			SELECT st6250.F03 '投资人帐号ID',st6141.F02 '投资人姓名',st6141.F07 '身份证号码',st6250.F06 '投标时间',st6250.F04 '投标金额'
			,(case WHEN st6250.F07='S' THEN '是' ELSE '否' END)'是否作废',st6230.F25 '标编号',st6230.F03 '借款标题',st6230.F05 '借款金额' ,st6230.F06 '借款利率'
			,(case WHEN st6230.F10='DEBX' THEN '等额本息' WHEN st6230.F10='MYFX' THEN '每月付息,到期还本' WHEN st6230.F10='YCFQ' THEN '本息到期一次付清' ELSE '等额本金' END)'还款方式'
			,(CASE WHEN st6230.F05=(SELECT SUM(st6252.F07) FROM s62.t6252 st6252 WHERE st6252.F05=7001 AND st6252.F09='YH' AND st6252.F03=st6230.F02) THEN '结清' ELSE '垫付' END) '还款状态'
			,(CASE WHEN st6230.F27='S' THEN '是' ELSE '否' END) '是否债转'
			FROM s62.t6250 st6250
			LEFT JOIN s61.t6141 st6141 ON st6250.F03=st6141.F01
			LEFT JOIN s62.t6230 st6230 ON st6250.F02=st6230.F01
			WHERE st6230.F03 not LIKE '%测试%';
		</div>
		<hr >
		<div id="">
			<h2>旧平台用户的充值流水(成立以来全部数据)</h2>
			SELECT r.user_id '注册帐号ID', (CASE u.user_type WHEN 'per' THEN '个人' WHEN 'ent' THEN '企业' ELSE '机构' END) as '用户类型'
			,u.real_name '姓名',decodeIdcard(u.idcard)'身份证号',u.mobile '电话',r.create_time '充值时间',r.lastupdate '到账时间',r.amount '充值金额'
			,r.billno '单号',(case WHEN r.paid_type='ALLINPAY' THEN '通联支付' WHEN r.paid_type='YEEPAYTG' THEN '易宝托管' WHEN r.paid_type='SHUANGQIAN' THEN '双乾支付' ELSE '双乾托管' END) '充值方式'
			,(case WHEN r.`status`='unpaid' THEN '未支付' WHEN r.`status`='paid' THEN '支付成功' ELSE '支付失败' END) '处理状态'  
			FROM recharge r
			LEFT JOIN `user` u ON u.id=r.user_id;
			<h2>新平台用户的充值流水(成立以来全部数据)</h2>
			
			SELECT st6502.F02 '注册帐号ID',(CASE st6110.F06 WHEN 'ZRR' THEN '自然人' ELSE '非自然人' END) '用户类型'
			,st6141.F02 '姓名' ,st6141.F07 '身份证',st6110.F04 '手机号码',st6501.F04 '充值时间',st6501.F06 '完成时间'
			,(CASE WHEN st6502.F14='PC' THEN '个人电脑' WHEN st6502.F14='APP' THEN '手机' ELSE '微信' END) '充值方式'
			,st6502.F03 '充值金额',st6501.F10 '单号'
			,(CASE WHEN st6501.F03='DTJ' THEN '待提交' WHEN st6501.F03='YTJ' THEN '已提交' WHEN st6501.F03='DQR' THEN '待确认' WHEN st6501.F03='CG' THEN '成功' ELSE '失败' END )'处理状态'
			FROM s65.t6502 st6502 
			LEFT JOIN s65.t6501 st6501 ON st6502.F01=st6501.F01
			LEFT JOIN s61.t6141 st6141 ON st6141.F01=st6502.F02
			LEFT JOIN s61.t6110 st6110 ON st6110.F01 = st6502.F02
			WHERE st6141.F02 is not null;
			
			<hr >
			SELECT st6509.F02 '注册帐号ID',(CASE st6110.F06 WHEN 'ZRR' THEN '自然人' ELSE '非自然人' END) '用户类型'
			,st6141.F02 '姓名' ,st6141.F07 '身份证',st6110.F04 '手机号码',st6501.F04 '充值时间',st6501.F06 '完成时间'
			,'线下充值',st6509.F03 '充值金额',st6501.F10 '单号'
			,(CASE WHEN st6501.F03='DTJ' THEN '待提交' WHEN st6501.F03='YTJ' THEN '已提交' WHEN st6501.F03='DQR' THEN '待确认' WHEN st6501.F03='CG' THEN '成功' ELSE '失败' END )'处理状态' 
			FROM s65.t6509 st6509
			LEFT JOIN s65.t6501 st6501 ON st6509.F01=st6501.F01
			LEFT JOIN s61.t6141 st6141 ON st6141.F01=st6509.F02
			LEFT JOIN s61.t6110 st6110 ON st6110.F01 = st6509.F02
			WHERE st6141.F02 is not null;
		</div>
		<hr >
		<div id="">
			<h2>旧平台用户提现流水(成立以来全部数据)</h2>
			SELECT w.user_id '注册帐号ID' , (CASE u.user_type WHEN 'per' THEN '个人' WHEN 'ent' THEN '企业' ELSE '机构' END) as '用户类型'
			,u.real_name '姓名',decodeIdcard(u.idcard)'身份证号',u.mobile '电话',w.create_time '提现时间',w.lastupdate '到账时间'
			,(CASE WHEN w.withdraw_type='URGENT' THEN '加急提现' ELSE '普通提现' END) '提现方式',w.amount '提现金额',w.third_fee '提现手续费'
			,b.`name` '开户行', bc.cardno '银行卡号',w.bill_no '单号'
			,(CASE WHEN w.`status`='applying' THEN '申请' WHEN w.`status`='apply_failed' THEN '申请失败' WHEN w.`status`='wait_audit' THEN '等待审核' WHEN w.`status`='audit_pass' THEN '审核通过' 
			WHEN w.`status`='releasing' THEN '放款中' WHEN w.`status`='release_failed' THEN '放款中失败' WHEN w.`status`='rejecting' THEN '拒收' WHEN w.`status`='reject_failed' THEN '拒收失败' 
			WHEN w.`status`='released' THEN '提现成功' ELSE '提现失败' END) '处理状态'
			FROM withdraw w
			LEFT JOIN `user` u ON u.id=w.user_id
			LEFT JOIN bank_card bc ON bc.user_id = w.user_id
			LEFT JOIN bank b ON b.id = bc.bank_id
			WHERE u.real_name is not null;
			<h2>新平台用户提现流水(成立以来全部数据)</h2>
			SELECT st6503.F02 '注册帐号ID' ,(CASE st6110.F06 WHEN 'ZRR' THEN '自然人' ELSE '非自然人' END) '用户类型'
			,st6141.F02 '姓名' ,st6141.F07 '身份证',st6110.F04 '手机号码',st6501.F04 '充值时间',st6501.F06 '完成时间'
			,st6503.F03 '提现金额',st6503.F05 '提现手续费',st6114.F05 '开户行',st6114.F07 '银行卡号',st6501.F10 '单号'
			,(CASE WHEN st6501.F03='DTJ' THEN '待提交' WHEN st6501.F03='YTJ' THEN '已提交' WHEN st6501.F03='DQR' THEN '待确认' WHEN st6501.F03='CG' THEN '成功' ELSE '失败' END )'处理状态' 
			FROM s65.t6503 st6503
			LEFT JOIN s65.t6501 st6501 ON st6503.F01=st6501.F01
			LEFT JOIN s61.t6141 st6141 ON st6141.F01=st6503.F02
			LEFT JOIN s61.t6110 st6110 ON st6110.F01 = st6503.F02
			LEFT JOIN s61.t6114 st6114 ON st6114.F02=st6503.F02
			WHERE st6141.F02 is not null;
		</div>
		<hr >
		<div id="">
			<h2>旧平台出借人获得利息明细表(成立以来全部数据)</h2>
			SELECT r.user_id '注册帐号ID',u.real_name '姓名',decodeIdcard (u.idcard) '身份证号' ,SUM(r.interest) '累计获得利息金额' 
			FROM `repayment_detail` r 
			LEFT JOIN loan_object lo ON lo.id = r.loan_id
			LEFT JOIN `user` u ON u.id=r.user_id 
			WHERE lo.title not LIKE '%测试%' AND r.`status`='paid' 
			GROUP BY r.user_id
			ORDER BY r.user_id;
			<h2>新平台出借人获得利息明细表(成立以来全部数据)</h2>
			SELECT st6252.F04 '注册账号ID',st6141.F02 '姓名',st6141.F07 '身份证号',SUM(st6252.F07) '累计获得利息金额' FROM s62.t6252 st6252
			LEFT JOIN s61.t6141 st6141 ON st6141.F01=st6252.F04
			LEFT JOIN s62.t6230 st6230 ON st6230.F01 = st6252.F02
			WHERE st6252.F05=7002 AND st6230.F03 not LIKE '%测试%'
			GROUP BY st6252.F04
			ORDER BY st6252.F04;
		</div>
		<hr >
		<div id="">
			<h2>旧平台出借人获得红包、活动奖励、推荐奖励等等明细表(成立以来全部数据)</h2>
			SELECT r.user_id '注册帐号ID',u.real_name '姓名', decodeIdcard(u.idcard) '身份证号',SUM(r.amount) '累计获得奖励金额' FROM referral_reward r
			LEFT JOIN `user` u ON u.id=r.user_id
			WHERE r.user_id IN (SELECT user_id FROM `bidding` GROUP BY user_id)
			GROUP BY r.user_id
			ORDER BY r.user_id
			<hr >
			SELECT ur.user_id '注册帐号ID',u.real_name '姓名', decodeIdcard(u.idcard) '身份证号',SUM(ur.amount) '累计获得奖励金额' FROM user_red_packet_list ur
			LEFT JOIN `user` u ON u.id = ur.user_id
			WHERE ur.user_id in (SELECT user_id FROM `bidding` GROUP BY user_id)
			AND ur.used_time is not null
			GROUP BY ur.user_id
			ORDER BY ur.user_id
			<hr >
			SELECT er.user_id '注册帐号ID',u.real_name '姓名', decodeIdcard(u.idcard) '身份证号',SUM(er.interest) '累计获得奖励金额' FROM experience_repayment er
			LEFT JOIN `user` u ON u.id=er.user_id
			WHERE er.user_id in (SELECT user_id FROM `bidding` GROUP BY user_id)
			GROUP BY er.user_id
			ORDER BY er.user_id
			
			<h2>新平台出借人获得红包、活动奖励、推荐奖励等等明细表(成立以来全部数据)</h2>
			
			SELECT st6310.F01 '注册帐号ID',st6141.F02 '姓名',st6141.F07 '身份证号',(st6310.F04+st6310.F05) '累计获得奖励金额' FROM s63.t6310 st6310
			LEFT JOIN s61.t6141 st6141 ON st6141.F01=st6310.F01
			WHERE (st6310.F04 >0 OR st6310.F05 >0) 
			AND st6310.F01 in (SELECT F03 FROM s62.t6250 GROUP BY F03)
			ORDER BY st6310.F01;
			
		</div>
	</body>
</html>
